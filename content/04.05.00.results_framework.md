### PhenoPLIER: an integration framework based on gene co-expression patterns

![
**Schematic of the PhenoPLIER framework.**
**a)** High-level schematic of PhenoPLIER (a gene module-based method) in the context of TWAS (single-gene) and GWAS (single-variant).
In GWAS, we identify variants associated with traits.
In TWAS, first, we identify variants that are associated with gene expression levels (eQTLs); then, prediction models based on eQTLs are used to impute gene expression, which is used to compute gene-trait associations.
Resources such as LINCS L1000 provide information about how a drug perturbs gene expression; at the bottom-right corner, we show how a drug downregulates two genes (A and C).
In PhenoPLIER, these data types are integrated using groups of genes co-expressed across one or more conditions (such as cell types) that we call gene modules or latent variables/LVs. Created with BioRender.com.
**b)** The integration process in PhenoPLIER uses low-dimensional representations (matrices $\mathbf{Z}$ and $\mathbf{B}$) learned from large gene expression datasets (top).
We used gene-drug information $\mathbf{L}$ from LINCS L1000 and gene-trait associations $\mathbf{M}$ from TWAS: PhenomeXcan was used as the discovery cohort, and eMERGE as replication (middle).
PhenoPLIER provides three computational components (bottom):
1) an LV-based regression model that associates an LV $j$ ($\mathbf{Z}_j$) with a trait $i$ ($\mathbf{M}_i$),
2) a clustering framework that learns groups of traits from TWAS associations projected into the LV space ($\hat{\mathbf{M}}$),
and 3) an LV-based drug repurposing approach that uses the projection of TWAS ($\hat{\mathbf{M}}$) and LINCS L1000 ($\hat{\mathbf{L}}$) into the LV space.
**c)** Genes that are part of LV603, termed as a neutrophil signature [@doi:10.1016/j.cels.2019.04.003], were expressed in relevant cell types (top), with 53 independent samples expressed in Neutrophils, 59 in Granulocytes, and 20 in Whole blood, 56 in PBMC, 8 in mDCs, 29 in Monocytes, and 5 in Epithelial cells (the boxplot shows the 25th, 50th and 75th percentiles while the whiskers extend to the minimum/maximum values).
LV603 was associated in PhenoPLIER with neutrophil counts and other white blood cells (bottom, showing the top 10 traits for LV603 after projecting gene-trait associations in PhenomeXcan).
eQTLs: expression quantitative trait loci;
MVN: multivariate normal distribution;
PBMC: peripheral blood mononuclear cells;
mDCs: myeloid dendritic cells.
](images/entire_process/entire_process.svg "PhenoPLIER framework"){#fig:entire_process width="100%"}


PhenoPLIER is a flexible computational tool designed to explore the connections between genes, traits, and drug effects by focusing on gene expression patterns in specific contexts (see Figure {@fig:entire_process}a).
It employs a method that captures the essence of gene modules through latent variables (LVs), using a comprehensive gene expression dataset (Figure {@fig:entire_process}b, top).
This method enables the simultaneous examination of genetic associations with traits and the impact of drugs on gene expression (Figure {@fig:entire_process}b, middle).
PhenoPLIER consists of three key components (outlined in Figure {@fig:entire_process}b, bottom and detailed in the [Methods](#sec:methods) section): 1) a model that uses LVs to identify associations between gene modules and traits, 2) a clustering method to group traits based on similar gene expression changes, and 3) a strategy for identifying potential drug treatments based on LVs that link diseases with therapeutic options.
To ensure accuracy and reliability, we conducted thorough simulations of our regression model ([Supplementary Note 1](#sm:reg:null_sim)) and clustering method ([Supplementary Note 2](#sm:clustering:null_sim)), confirming their effectiveness in situations without pre-existing associations.


In our study, we analyzed gene-trait associations by utilizing data from PhenomeXcan and the eMERGE network as our primary and secondary datasets, respectively.
PhenomeXcan integrates genetic information from the UK Biobank and other studies to provide associations for over 4,091 diseases and traits.
On the other hand, our analysis with the eMERGE network covered 309 distinct disease codes.
We employed two different statistical approaches from the Transcriptome-Wide Association Studies (TWAS) to analyze the data: Summary-MultiXcan (S-MultiXcan) and Summary-PrediXcan (S-PrediXcan).
S-MultiXcan was used to identify and group related diseases and traits, while S-PrediXcan helped us in pinpointing potential drugs for repurposing based on gene expression changes.
Additionally, we incorporated colocalization analyses to assess the likelihood of shared genetic signals between GWAS (genome-wide association studies) and eQTL (expression quantitative trait loci) studies.
For the drug repurposing aspect of our research, we analyzed the effects of 1,170 small molecule drugs on gene expression using data from the LINCS L1000 project.


The latent gene expression profiles were derived using MultiPLIER models, which employ a matrix factorization technique known as PLIER to analyze a comprehensive dataset called recount2.
This dataset encompasses a wide variety of samples, detailing gene expression across different diseases, cell types, stages of differentiation, and responses to various stimuli (refer to the Methods section).
The MultiPLIER approach successfully extracted 987 Latent Variables (LVs), focusing not only on optimizing data reconstruction but also on ensuring these LVs correspond with established pathways and prior knowledge.


Each Latent Variable (LV) or gene module is a collection of genes that are expressed together in specific tissues and cell types, acting as a functional group.
LVs are thought to represent sets of genes controlled by the same transcriptional mechanisms, suggesting that integrating gene association studies and drug effect data into this framework could enhance our understanding of disease mechanisms and drug actions.
PhenoPLIER, the tool we used, transforms gene associations into an LV score by combining the effect sizes for traits (from gene association studies) or changes in gene expression due to drugs (from drug studies) with the weights of genes in an LV, resulting in a single comprehensive value.
This method shifts the focus from individual genes to clusters of genes (LVs) that are linked to specific traits and drugs, thereby associating them with functionally related gene groups.

PhenoPLIER also leverages information on where and when these gene groups are expressed, such as in certain cell types or tissues, during specific developmental or disease stages, or in response to particular stimuli.
This information, provided by MultiPLIER's models, significantly enhances the interpretability of the results.
For example, the models connect LVs to annotated samples, indicating the experimental conditions of gene expression within an LV (illustrated in Figure 2b).
A case in point is LV603, which was previously identified to be associated with a neutrophil pathway and correlated with neutrophil counts from RNA-seq profiles.
Our analysis with PhenoPLIER revealed that traits related to neutrophil and other white blood cell counts were among the top-ranked associations for LV603 (shown in Figure 2c, bottom), and that LV603 was significantly linked to basophil counts and percentages (Table 1).
Additionally, the genes in LV603 were found to be expressed in relevant cell types (Figure 2c, top).

These findings underscore that gene groups, which are functionally related and co-expressed, often align with clusters of traits, suggesting that our approach can effectively connect transcriptional mechanisms from extensive datasets to complex traits.


<!--
ERROR: the paragraph below could not be revised with the AI model due to the following error:

Request failed due to server shutdown {
  "error": {
    "message": "Request failed due to server shutdown",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'Request failed due to server shutdown', 'type': 'server_error', 'param': None, 'code': None}} {'Date': 'Tue, 19 Mar 2024 17:01:20 GMT', 'Content-Type': 'application/json', 'Content-Length': '141', 'Connection': 'keep-alive', 'access-control-allow-origin': '*', 'openai-model': 'gpt-4-0125-preview', 'openai-organization': 'university-of-pennsylvania-201', 'openai-processing-ms': '16293', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '500', 'x-ratelimit-limit-tokens': '450000', 'x-ratelimit-remaining-requests': '499', 'x-ratelimit-remaining-tokens': '449275', 'x-ratelimit-reset-requests': '120ms', 'x-ratelimit-reset-tokens': '96ms', 'x-request-id': 'req_bd9017d047c9142d48dea1a1cbe62c16', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '866f05b77ec33ae4-IAD', 'alt-svc': 'h3=":443"; ma=86400'}
-->
Therefore, PhenoPLIER allows the user to address specific questions, namely: do disease-associated genes belong to modules expressed in specific tissues and cell types? Are these cell type-specific modules associated with _different_ diseases, thus potentially representing a "network pleiotropy" example from an omnigenic point of view [@doi:10.1016/j.cell.2017.05.038]? Is there a subset of module's genes that is closer to the definition of "core" genes (i.e., directly affecting the trait with no mediated regulation of other genes [@doi:10.1016/j.cell.2019.04.014]) and thus represents alternative and potentially better candidate targets? Are drugs perturbing these transcriptional mechanisms, and can they suggest potential mechanisms of action?

